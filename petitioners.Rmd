---
title: "QS petitioners and supporters"
description: |
  A closer look at the people behind petitions
author:
  - name: Sharon Howard 
output: distill::distill_article
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r message=FALSE}
#source("_data.R") v1

# checked and updated with public data, excl Herts.
# and checked alt text numbers.

source("data.R")

# viz, ggplot extensions etc
library(ggthemes)
theme_set(theme_minimal()) # set preferred ggplot theme 

library(vcd)

### devtools::install_github("hrbrmstr/waffle")
library(waffle)
library(hrbrthemes)

library(ggridges)
##https://github.com/wilkox/treemapify
library(treemapify)

library(patchwork)

library(RColorBrewer)
# nb.cols <- 18
# mycolors <- colorRampPalette(brewer.pal(8, "Set2"))(nb.cols)
# scale_fill_manual(values = mycolors) +
```





```{r petrs-and-subs-data}
# Herts is obvs missing at the moment...
# did the previous sqlite petitioners include collective? i think it might have. not sure if it matters... doesn't seem to.

# MAKE SHORT LABELS FOR COUNTIES?

qs_petitioners_subs <-
qs_petitioners_sqlite %>%
  # single-column unique id for each petition to match petitions, make joins easier
  # will this work for herts? seems to. nb end _NA but they are unique.
  mutate(petition_id = paste(county, petition_id, sep="_")) %>%
  inner_join(qs_petitions_combined %>% select(petition_id, topic, decade, year, #year_strict, year_parse, 
                                              bho_transcribed, petition_type, petition_type_s, subscribers, named_petrs), by="petition_id") %>%
  # i think no petitioner_signed column in this v of the data? but can work that out from name_type/signature_type cols if needed...?
  # simplified signature type, diff not transcribed (NA) and not signed [none]
    mutate(signature_type = case_when(
      county=="Herts" ~ NA_character_,
    county=="Cheshire" & bho_transcribed=="n" ~ NA_character_,
    sig_type %in% c("in", "m") ~ "mark",
    sig_type=="sig" ~ "sign",
    sig_type=="ss" ~ "scribe",
    is.na(sig_type) ~ "[none]"
  ))  %>%
  mutate(petitioner_signed = case_when(
    is.na(signature_type) ~ NA_character_,
    signature_type %in% c("scribe", "[none]") ~ signature_type,
    signature_type %in% c("mark", "sign") ~ "signed"
  )) 


qs_petitioners <-
  qs_petitioners_subs %>%
  filter(name_type !="sub")

qs_subs <-
  qs_petitioners_subs %>%
  filter(name_type=="sub")
```


```{r petitioners-functions}
# ???
# now it's working no problem... 
percent_one_petitioner_grp <- function(grp){
  qs_petitions_combined %>%
  count({{grp}}, named_petrs, petition_type) %>%
  group_by({{grp}}) %>%
  mutate(p = n/sum(n), s=sum(n)) %>%
  ungroup() %>%
    # exclude any collective with 1 named_petr who's ob
  filter(named_petrs==1, petition_type=="single") %>%
  ggplot(aes(fct_reorder({{grp}}, p), p)) +
  geom_point(aes(size=s), shape="square") +
  geom_col(width=0.03) +
  coord_flip() +
  scale_y_continuous(labels = percent_format(), limits = c(0,1)) +
  labs(y="% of petitions with one named petitioner", size="petitions")
}



qs_pet_types_mosaic <- function(grp){
  
qs_petitions_combined %>%
  count({{grp}}, petition_type_s) %>%
  group_by({{grp}}) %>%
  mutate(p = n/sum(n), s=sum(n)) %>%
  ungroup() %>%
  mutate(grp=factor({{grp}})) %>%
  # why does this work but continuing to use {{grp}} doesn't...
  mutate(#grp = fct_reorder(grp, -s),
         petition_type_s = fct_relevel(petition_type_s, "single", "collective", "group")) %>%
  ggplot(aes(x=grp, y = p, width = s, fill = petition_type_s)) +
  geom_col(position = "fill", colour="white") +
  scale_fill_ptol() +
  scale_y_continuous(labels = percent_format()) +
  facet_grid(~grp, scales = "free_x", space = "free_x")  +
  theme(panel.spacing = unit(0, "lines"), strip.text.x = element_blank() ) +
  labs(fill="type", y="% of petitions")
}
```


## Quarter Sessions petitioners 

I'm using data from TPOP's transcribed QS collections (Cheshire, Derbyshire, Staffordshire, Westminster and Worcestershire), as well as additional data I've collected for a larger sample of untranscribed Cheshire files, for a total of ``r qs_petitions_combined %>% tally() %>% pull(n)  `` petitions. 

The data is available, with full documentation, from [Zenodo](https://doi.org/10.5281/zenodo.7027692).

```{r}
#qs_petitions_combined %>% tally() %>% pull(n) # 1728
#qs_petitioners %>% tally() %>% pull(n)  # 1807 was 2200 and something
#qs_subs %>% tally() %>% pull(n) # 3531 unchanged
```


[**Note**: the first version of this page also included date for about 400 Hertfordshire petitions, for which I had less detailed information. The Hertfordshire data has not been included in TPOP's public data release and it made only very minor differences to the analysis on this page, so I've removed it for now. Some statistics will differ from the original version.]

**What is a petitioner?** TPOP's petitions have two main types of participant. Most QS petitions have one or more named **petitioners** at the head of the petition (often, "The humble petition of X"), including in some cases people on whose behalf the petition was made (who are counted as petitioners). 

Meanwhile, **subscribers** are those who signed their names in support of the petition, either in the space below the main text or on an attached document. In some petition archives, **collective** petitions, which have *only* subscribers (and might have thousands of them) are the most familiar type of petition; this is rather less common in QS records, and it's quite common for QS collective petitions not to have any named subscribers either.
[Other names which may appear on petitions are not considered here: signatures of clerks, lawyers, judges or other officials; and mentions of individulas, especially the subjects of petitioners' complaints, in the body of a petition.]

Using these definitions, I have some information about individuals for ``r qs_petitioners %>% tally() %>% pull(n) `` named petitioners and ``r qs_subs %>% tally() %>% pull(n) `` subscribers. Potentially meaningful information which is available for at least some petitioners and subscribers:

- nearly all have gender information, on the basis of first names (>99% of petitioners and ~95% of subscribers)
- for transcribed petitions, signature types (name, initials, marks) of signed names
- occupation/social status and locations for some names (but both of these would need more work to make them usable than is possible here)

It should be noted that the Derbyshire collection is only a partial set of surviving petitions in the Derbyshire QS records which are, moreover, [a bit different from the other counties' archives](https://www.british-history.ac.uk/petitions/derbyshire/introduction#h3-0002) (in that they did not survive in the usual sessional organisation). Many petitions were excluded because they were undateable and there were very uneven clusters among those that could be dated). I've kept them in the analysis for now, but they're often very anomalous and I'm increasingly doubtful that anything can be read into the differences.



## Making petitioners count

```{r}
# number of petrs in petitions seems to match count of petrs.
# qs_petitions_combined %>%
#   select(petition_id, named_petrs) %>%
#   inner_join(qs_petitioners %>% count(petition_id), by="petition_id") %>%
#   filter(named_petrs !=n)
```



```{r petrs-data-processing}
# why have numbers and % changed since i first wrote this... 
# maybe i did calcs based on named_petrs ? aha! i think behalfs are in named_petrs... oops
# i had 1513 solo 71%; 382 collective; 246? group
# nb 88 collective petitions include on behalf (4.1% of total) and 32 group = on behalf (1.5%)
qs_petitions_single <-
qs_petitions_combined %>%
  count(petition_type_s) %>%
  mutate(p = round(n/sum(n)*100,1)) %>%
  filter(petition_type_s=="single") %>%
  mutate(p=paste0(p, "%"))
# n was 1430, 67%

qs_petitions_group <-
qs_petitions_combined %>%
  count(petition_type_s) %>%
  mutate(p = round(n/sum(n)*100,1)) %>%
  filter(petition_type_s=="group") %>%
  mutate(p=paste0(p, "%"))
# was 238

qs_petitions_collective <-
qs_petitions_combined %>%
  count(petition_type_s) %>%
  mutate(p = round(n/sum(n)*100,1)) %>%
  filter(petition_type_s=="collective") %>%
  mutate(p=paste0(p, "%"))
# was 473

qs_petitions_behalf <-
qs_petitions_combined %>%
  count(petition_type) %>%
  filter(str_detect(petition_type, "behalf"))
# was 88 and 32 which seems quite a big difference?
```


```{r}
# qs_petitions_combined %>% 
#   filter(petition_type_s=="group") %>%
#   count(named_petrs) 

# this appears to include some collective petitions???
# think i've just discovered what the last name was for...
# qs_petitions_combined %>%
#   filter(petition_type_s=="group") %>%
#   select(petition_id, petitioner) %>%
#   filter(!str_detect(petitioner, "wife|daughter|\\bson|sister|brother|mother|father")) %>%
#   inner_join(qs_petitioners %>% select(petition_id, name) %>%
#                group_by(petition_id) %>%
#                summarise(pr = paste(name, collapse=" | ")) %>% ungroup()
#              , by="petition_id") %>%
#   relocate(pr) %>%
#   View()
# 44 include wife|daughter|\\bson|sister|brother|mother|father 
# 14 eyeballing people with same surname - could have missed some so it's a minimum.
# 58
```

By far most petitions were initiated by a single person (``r qs_petitions_single %>% pull(n) `` petitions, about ``r qs_petitions_single %>% pull(p) ``). For the other `30%`, the most noticeable feature is that petitions by groups of named petitioners are less common than those from collectives (with or without named subscribers): there were ``r qs_petitions_collective %>% pull(n) `` collective petitions (including `39` on behalf of a named person(s)), compared to ``r qs_petitions_group %>% pull(n) `` petitions with multiple named petitioners (including `14` on behalf of someone). 

Moreover, the vast majority of named group petitions are by very small groups. `132` have just two petitioners, only `17` have more than five and just `3` petitions have more than ten. It seems likely to me that group petitions are often the work of close relatives or working colleagues. At least `60` group petitions include people who are married couples, are stated to be relatives or share surnames. There are further group petitions from constables, other local officials or business partners, directly concerned with shared responsibilities or work.


```{r qs_petrs_histogram_petrs_per_petition, fig.alt='histogram showing numbers of named petitioners per petition in the Power of Petitioning Quarter Sessions collections. The largest group of petitioners (about 1200) has only one petitioner.'}
#  qs_petrs_... , fig.alt='type of chart... of ... in the Power of Petitioning Quarter Sessions collections, note any interesting points about presentation. summarise key findings'
qs_petitions_combined %>% #count(named_petrs) 0=382
  #filter(county !="Herts")
  #filter(named_petrs>0) %>% 
  ggplot(aes(named_petrs)) +
  geom_histogram(binwidth = 1) +
  labs(x="number of petitioners", title="Named petitioners per QS petition", caption = "excludes subscribers; 0=collective petition")
```


This shows subscribers only, for petitions that have them, and excluding a tiny handful of petitioners with more than 50 subscribers. Once again, 1 is the most frequent number of subscribers, but there is a much longer tail. Subscribers average `9.4` per petition, cf. `1.25` petitioners. However, more than a third of collective petitions had no signatures at all (`128`); obtaining signatures was clearly not essential to support collective petitioning

```{r}
# subs (>0) mean 9.75, median 7
# petrs (>0) 1.267197 /	1	
# qs_petitions_combined %>%
#   filter(named_petrs>0) %>% summarise(mn = mean(named_petrs), md=median(named_petrs))
# qs_petitions_combined %>%
#   filter(subscribers>0) %>% summarise(mn=mean(subscribers), md=median(subscribers))
# qs_petitions_combined %>%
#   filter(petition_type_s=="collective") %>% # 330
#   count(subscribers)
```



```{r qs_petrs_histogram_subscribers_per_petition, fig.alt='histogram of subscribers to petitions in the Power of Petitioning Quarter Sessions collections; as with petitioners the largest single group have just one subscriber, but it is a much wider distribution with significant numbers of petitions having up to 25 subscribers.'}
qs_petitions_combined %>%
  select(county, named_petrs, subscribers) %>%
  filter(subscribers>0) %>% 
  #filter(subscribers<60) %>% 
  #summarise(mn=mean(subscribers), md=median(subscribers))
  #mutate(all_names = named_petrs+subscribers) %>% #count(all_names)
  ggplot(aes(subscribers)) +
  geom_histogram(binwidth = 1) +
  labs(x="number of subscribers", title="Subscribers per petition")
```



```{r}
# TIL wrangle percentages of groups: count(a, b) %>% group_by(a) %>% mutate(pc = n/sum(n))
# qs_petitions_combined %>%
#   select(petition_id, named_petrs, county, decade, topic, gender) %>%
#   count(county, named_petrs) %>%
#   group_by(county) %>%
#   mutate(p = n/sum(n)) %>%
#   filter(named_petrs==1) 
```


### counties

The proportions of solo / collective / group petitions can vary geographically.


```{r include=FALSE}
# what about petitions that are actually 1 petr + on behalf? treat as multiple
# only 32 m.o.b. petitions so it's not exactly a big deal; 31 of them are 2 named

# anomalous =collective/>0 petrs are all "name and the collective". 
# only 3 of them...  histogram will be treating them correctly
# 3rd has 3 named and 0 subscribers so make it multiple not collective
# first two have 1 named + several subs. hmm! i think single not collective.

# how to treat collective on behalf for numbers?
# want to compare subscribers for collective / named. 
# but how do collective on behalf fit into that?
# 
# collective on behalf: 88. 1 named=81, 2 named=5, only 2 have more than 2. are any of them named *petr* rather than ob? nope. all ob afaict.
```

```{r include=FALSE}
# TIL viz mosaic just using ggplot 
# https://stackoverflow.com/questions/19233365/how-to-create-a-marimekko-mosaic-plot-in-ggplot2
# My solution was to use geom_bar together with the scales="free_x", space="free_x" option in facet_grid to accommodate different bar widths:
# using diamonds dataset for illustration
# diamonds %>%
#   group_by(cut, clarity) %>%
#   summarise(count = n(), .groups = "drop_last") %>%
#   mutate(cut.count = sum(count),
#          prop = count/sum(count)) %>%
#   ungroup() %>%
#   ggplot(aes(x = cut, y = prop, width = cut.count, fill = clarity)) +
#   geom_bar(stat = "identity", position = "fill", colour = "black") +
#   # geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
#   facet_grid(~cut, scales = "free_x", space = "free_x") +
#   scale_fill_brewer(palette = "RdYlGn") +
#   # theme(panel.spacing.x = unit(0, "npc")) + # if no spacing preferred between bars
#   theme_void() 
```


The percentage of group petitions appears to be relatively consistent across the counties (except for Derbyshire); the main variation here is between single and collective, hinting at regional variations in petitioning cultures.

```{r}
# qs_petitions_combined %>%
#   count(petition_type_s, county) %>%
#   group_by(county) %>%
#   mutate(p = n/sum(n)) %>%
#   ungroup()
```


```{r qs_petrs_ggmosaic_petitioner_types_county, fig.alt='Mosaic chart of solo, group and collective petitions in the Power of Petitioning Quarter Sessions collections, broken down by county. Most petitions are from a single petitioner, but percentages vary, from 78% solo in Westminster to 60% solo in Worcestershire. There is least variation in the percentage from named groups.'}
qs_pet_types_mosaic(county) +
  labs(title="Solo and collective petitioning, by county", x="county", fill="petitioner\ntype")
# do i need short labels again for this? i think it might be a good idea
```






```{r}
# why doesn't this order things large>small like the examples? annoying
# qs_petitions_combined %>%
#   select(named_petrs, subscribers, petition_type, county) %>%
#   mutate(pets_cat = case_when(
#     petition_type=="single" & named_petrs==1 ~ "s",
#     str_detect(petition_type, "collective") ~ "c",
#     str_detect(petition_type, "multiple") ~ "m"
#   )) %>% 
#   add_count(pets_cat) %>%
#   ggplot() +
#   ggmosaic::geom_mosaic(aes(x=ggmosaic::product(pets_cat, county), fill=pets_cat )
#                         ) +
#   scale_fill_ptol() 
```




```{r}
# TIL viz ggplot interesting that you can have multiple labs(). you can even replace previously specified labels. might be handy for overriding function defaults.
# percent_one_petitioner_grp(county) +
#   labs(x="county", title="Solo petitioning, by county")
```



### topics


```{r}
##Certain petition topics stand out as particularly collective, eg rates or dissenting worship.
# qs_petitions_combined %>%
#   ggplot(aes(named_petrs)) +
#   geom_histogram(binwidth = 1) +
#   facet_wrap(~topic, scales = "free_y")
```

Because of the larger number of topics, it's more effective to focus on the proportion of petitions by solo petitioners rather than the full breakdown. (This time, the size of squares is used to indicate the number of petitions in the group.) 

Petitions complaining about local rates and taxes clearly tend to be group/collective affairs, or at least presented as such (communities organising together to complain about unfair rate assessments compared to other towns or villages more often than individual complaints of unfairness compared to neighbours). Dissenters' petitions, though a small category, are specifically applications to license places of worship and brought by local communities rather than single individuals. On the other hand, more predominantly solo efforts include petitions about military relief, poor relief and child support. 

```{r}
# overall % solo=nearly 67.
# qs_petitions_combined %>%
#   count(petition_type_s) %>%
#   mutate(p = n/sum(n)*100)
```


```{r}
# is this putting petrs and subrs together or is it just petrs?
# qs_pet_types_mosaic(topic) +
#   scale_x_discrete(guide = guide_axis(angle=45)) +
#   labs(x="topic", title="Petition types, by petition topic")
```


```{r qs_petrs_lollipop_solo_petitions_percent , fig.alt='lollipop chart of the percentage of petitions in the Power of Petitioning Quarter Sessions collections that were by a single petitioner, break down by petition topic. The lowest percentages include complaints about rates/taxes and alehouses, and the highest include poor-/military-relief related petitions and those from debtors.'}

percent_one_petitioner_grp(topic) +
  labs(x=NULL, title="Solo petitioner petitions, by topic")
```

### change over time


```{r}
##What this indicates is that the solo-collective-group proportions were relatively consistent through the first half of the 17th century, when petition numbers were largest, and then began to become less stable as numbers declined, which may well be the result of small numbers rather than anything more meaningful.
# qs_pet_types_mosaic(decade)+
#   scale_x_discrete(guide = guide_axis(angle=45)) +
#   labs(x="decade", title="Petitioner types, by decade")
```

There may be a long-term shift towards solo petitioning, though it's far from conclusive. For much of the 17th century the percentage of solo petitioners is relatively consistent; fluctuations become more noticeable after petition numbers fall from the late 17th century onwards. However, the overall 18th-century solo average (`73%`) *is* higher than that for the 17th century (`69%`), and the late-16th-century solo average is even lower at `49%`.

```{r}
  # qs_petitions_combined %>%
  # filter(!is.na(decade)) %>%
  # mutate(pd = case_when(
  #   decade<1600 ~ "16",
  #   decade<1700 ~ "17",
  #   TRUE ~ "18"
  # )) %>%
  # count(pd, named_petrs, petition_type_s) %>%
  # group_by(pd) %>%
  # mutate(p = n/sum(n), s=sum(n)) %>%
  # filter(named_petrs==1, petition_type_s=="single")
```


```{r  qs_petrs_scatter_trend_solo_petitions_decade, fig.alt='scatter plot with trend line of percentage of petitions with a single petitioner in the Power of Petitioning Quarter Sessions collections, by decade between late 16th and late 18th centuries. There is probably a slight overall increase over the period, but it fluctuates a good deal.'}

  qs_petitions_combined %>%
  filter(!is.na(decade)) %>%
  count(decade, named_petrs, petition_type_s) %>%
  group_by(decade) %>%
  mutate(p = n/sum(n), s=sum(n)) %>%
  filter(named_petrs==1, petition_type_s=="single") %>%
  ggplot(aes(decade, p)) +
  geom_point(aes(size=s), shape="square") +
  geom_smooth(formula = y~x, method="loess") +
  #coord_flip() +
  scale_y_continuous(labels = percent_format(), limits = c(0,1)) +
  labs(y="% of petitions with one named petitioner", size="petitions")
```




```{r}
##on behalfs? #### 
# are there enough to be worth doign anything quant with. only 130. but there are clear diffs per county...
# qs_petitioners_combined %>%
#   count(county, name_type)
```



## Gender

```{r}
#qs_subscribers_combined %>% count(gender) %>% mutate(p=n/sum(n)*100)
#qs_petitioners_combined %>% count(gender) %>% mutate(p=n/sum(n)*100)
```

The majority of petitioners are men; only about `25%` of named petitioners are female. 

```{r qs_petrs_waffle_gender_petitioners, fig.alt='waffle chart of petitioner gender in the Power of Petitioning Quarter Sessions collections. 1356 petitioners are male, 442 female.'}

qs_petitioners %>%
#qs_petitioners_combined %>% 
  # mutate(petr_sub="petitioners") %>%
  # bind_rows(qs_subscribers_combined %>% mutate(petr_sub="subscribers")) %>%
  filter(gender %in% c("male", "female")) %>%
  count(gender)%>%
  ggplot(aes(fill=gender, values=n)) +
  geom_waffle(colour="white", flip=TRUE, #make_proportional = TRUE, 
              n_rows = 50)+
  coord_equal() +
    #facet_wrap(~petr_sub, nrow=1) +
  theme_minimal() +
  theme_enhance_waffle() +
  scale_fill_manual(values=c("#fc8d59", "#810f7c"), guide = guide_legend(reverse = TRUE)) +
 # theme(legend.position = "bottom") +
  labs(fill="gender", title="Gender of QS petitioners", caption="1 square = 1 petitioner")

```

But the gender disparity is *much* greater for subscribers, of whom only about **`2%`** are women.

```{r qs_petrs_waffle_gender_subscribers, fig.alt='waffle chart of petition subscribers gender in the Power of Petitioning Quarter Sessions collections: 3313 male, 71 female.'}

qs_subs %>%
  filter(gender %in% c("male", "female")) %>%
  count(gender) %>% #mutate(p=n/sum(n))
  ggplot(aes(fill=gender, values=n)) +
  geom_waffle(colour="white", flip=TRUE, #make_proportional = TRUE, 
              n_rows = 60)+
  coord_equal() +
  #  facet_wrap(~petr_sub, nrow=1) +
  theme_minimal() +
  theme_enhance_waffle() +
  scale_fill_manual(values=c("#fc8d59", "#810f7c"), guide = guide_legend(reverse = TRUE)) +
 # theme(legend.position = "bottom") +
  labs(fill="gender", title="Gender of QS subscribers", caption="1 square = 1 subscriber")

```

Women are also more likely than men to be solo petitioners. 



```{r qs_petrs_waffle_gender_petitioners_pet_type, fig.alt='waffle chart of petitioner gender in the Power of Petitioning Quarter Sessions collections, comparing single vs group petitions. About 77% of female petitioners are solo, and 66% of male petitioners.'}
# TIL viz geom_waffle: for fill legend correct ordering. in scale_fill* use guide = guide_legend(reverse = TRUE)
qs_petitioners %>%
  filter(gender %in% c("female", "male", "mixed"), petition_type_s!="collective") %>%
  count(petition_type_s, gender)%>%
  #group_by(gender) %>% mutate(p=n/sum(n))
  ggplot(aes(fill=petition_type_s, values=n)) +
  geom_waffle(colour="white", flip=TRUE, make_proportional = TRUE, 
              n_rows = 10)+
  coord_equal() +
  facet_wrap(~gender, nrow=1) +
  theme_minimal() +
  theme_enhance_waffle() +
  scale_fill_tableau(guide = guide_legend(reverse = TRUE)) +
#  scale_fill_manual(values=c("#fc8d59", "#810f7c"), guide = guide_legend(reverse = TRUE)) +
  labs(fill="gender", title="Gender of QS petitioners, by petition type", caption="1 square = 1% of petitioners")

```


Moreover, there are *no* all-female petitioner groups larger than two people (women also tend to be very much in the minority in larger mixed groups). So it's clear that men were far more involved with petitioning as an organised collective or group activity. The absence of women as subscribers may imply that supporters were most often recruited on a household basis, with men signing as heads of households.

```{r qs_petrs_histogram_gender_petitioners_per_petition, fig.alt='histograms of petitioners per petition in the Power of Petitioning Quarter Sessions collections, comparing all female, all male and mixed gender petitions.'}

qs_petitions_combined %>% 
  filter(gender %in% c("female", "male", "mixed"), petition_type!="collective") %>%
  ggplot(aes(named_petrs)) +
  geom_histogram(binwidth = 1) +
  labs(x="number of (named) petitioners", title="Histogram of petitioners per petition, by gender") +
  facet_wrap(~gender, scales="free_y")
```

```{r}
# qs_petitioners_combined %>%
#   select(gender, petition_type_s, name_type, petr_or_sub, petition_id) %>%
#   inner_join(qs_petitions_combined %>% filter(gender=="mixed") %>% select(petition_id, pet_gender= gender), by="petition_id") %>%
#   filter(petr_or_sub=="petr", gender %in% c("male", "female")) %>%
#   count(petition_id, gender) %>%
#   group_by(petition_id) %>%
#   mutate(p = n/sum(n), s=sum(n)) %>%
#   ungroup() %>%
#   #filter(gender=="female") %>%
#   arrange(s) %>%
#   ggplot(aes(s, n, colour=gender)) +
#   geom_point() 
```


```{r}
#Women do not petition in groups without men.?
# qs_petitions_combined %>%
#   filter(gender !="na") %>%
#   ggplot(aes(named_petrs)) +
#   geom_histogram(binwidth = 1) +
#   facet_wrap(~gender, scales = "free_y")
```

Comparing gender across counties: Staffs is noticeably lower female % (about `15%`) than the other four counties (`25-30%`).


```{r qs_petrs_waffle_gender_petitioners_county, fig.alt='waffle charts of petitioner gender, breakdown by county.'}
# thread https://twitter.com/sharon_howard/status/1222197505380749312  [2020/01/28]
# Who likes waffle charts?

# TIL viz geom_waffle: for fill legend correct ordering. in scale_fill* use guide = guide_legend(reverse = TRUE)
qs_petitioners %>%
  filter(gender %in% c("male", "female")) %>%
  count(county, gender) %>% 
  ggplot(aes(fill=gender, values=n)) +
  geom_waffle(colour="white", flip=TRUE, make_proportional = TRUE, n_rows = 5)+
  coord_equal() +
  facet_wrap(~county, nrow=1) +
  theme_minimal() +
  theme_enhance_waffle() +
  scale_fill_manual(values=c("#fc8d59", "#810f7c"), guide = guide_legend(reverse = TRUE)) +
  labs(fill="gender", title="Gender of QS petitioners, by county", caption="1 square = 1% of petitioners")

# also
# https://twitter.com/sharon_howard/status/1222433500244205568
# https://twitter.com/sharon_howard/status/1222202003704684547

```


It's not very surprising that female participation also varies with petition topic (and this at least to some extent correlates with topics that were more or less likely to be solo vs group/collective); in particular very few women are involved in petitions about rates, while approaching half of petitioners for poor relief.

```{r qs_petrs_waffle_gender_petition_topic, fig.alt='waffle charts of petitioner gender in the Power of Petitioning Quarter Sessions collections, breakdown by petition topics.'}
qs_petitioners %>%
  filter(gender %in% c("male", "female"), topic!="other") %>%
  count(topic, gender)%>%
  ggplot(aes(fill=gender, values=n)) +
  geom_waffle(colour="white", flip=TRUE, make_proportional = TRUE, n_rows = 10)+
  coord_equal() +
  facet_wrap(~topic, nrow=2) +
  theme_minimal() +
  theme_enhance_waffle() +
  scale_fill_manual(values=c("#fc8d59", "#810f7c"), guide = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom") +
  labs(fill="gender", title="Gender of QS petitioners, by petition topic") #, caption="1 square = 1% of petitioners")

```



## Signing petitions

There was no requirement to sign a petition and the majority of petitioners did not sign their petitions at all. Therefore, this is *not* an attempt to analyse signatures for evidence of literacy. But why did some petitioners sign their names if the majority didn't bother? What, if anything, is the social/cultural/legal significance of a signature in a petition? It might not be the same as in witness examinations or other legal documents (for which signatures usually *were* required). So I'm curious as to whether there are any patterns of interest.

I only have partial data for the untranscribed Cheshire petitions, so they're excluded from this section. Overall, there's some kind of signature for `24%` of petitioners in the transcribed collections. 

In transcriptions, signatures were also marked up for "type" of signature:

- mark
- initial(s)
- autograph signature
- name written in the same hand as the main petition text

The last of these can be difficult to interpret. In most cases, it's *not* because the petition was written by the petitioner; inspection of the Cheshire petition images indicates that the only instances of this were less typical petitionary letters. In some cases - certainly for subscribers - it looks possible that the petition is a copy rather than the original document. For petitioners it's hard to be sure whether it's a copy of an original autograph or a scribal decision to write out the name as a kind of pseudo-signature and so I'll only include them in breakdowns by signature type.

Initials are very rare (<10, only 1 of which is for a petitioner) and so are counted with marks for this analysis. However, this in itself seems quite noteworthy, as I might expect them to be more common based on my recollection of other types of document in early modern court archives such as witness examinations. (Though I wouldn't guarantee that my memory is reliable, and I'd need some data to verify this.)

Moreover, as can be seen, even when combined marks and initials are not very common (only `2%` of all petitioners signed this way, or `12%` of signatures excluding scribal) - considerably less common, I suspect, than in witness examinations even though I might expect petitioners to be of fairly similar social status to witnesses.


```{r}
## are petitioners more likely to sign if there are subscribers as well? very slightly. but difference is marginal
  # qs_petitioners_combined %>%
  # filter(!is.na(signature_type), signature_type!="scribe") %>%
  # select(reference, name_type, petition_type_s, petitioner_signed, signature_type, subscribers, named_petrs) %>%
  # count(signature_type, subscribers>0) %>%
  # group_by(signature_type) %>%
  # mutate(p = n/sum(n)*100) %>%
  # ungroup()
```



```{r qs_petrs_waffle_petitioners_signatures, fig.alt='waffle chart of petitioner signatures in the Power of Petitioning Quarter Sessions collections. The majority did not sign their petitions and very few who did sign used a mark.'}

qs_petitioners %>%
  filter(!is.na(signature_type)) %>%
  count(signature_type) %>% #filter(signature_type %in% c("mark", "sign")) %>% mutate(p=n/sum(n)*100)
  ggplot(aes(fill=signature_type, values=n)) +
  geom_waffle(colour="white", flip=TRUE, #make_proportional = TRUE, 
              n_rows = 40) +
  coord_equal() +
  theme_minimal() +
  theme_enhance_waffle() +
  #scale_fill_tableau(guide = guide_legend(reverse = TRUE)) +
  scale_fill_pander(guide = guide_legend(reverse = TRUE)) +
  #theme(legend.position = "bottom",strip.text = element_text(angle = 45)) +
  labs(fill="type", caption="1 square = 1 petitioner", title="Signature types for petitioners")
```


The same for subscribers, and here (since there are no "[none]" to worry about) the low percentage of supporters signing by mark/initials is really striking, at about `4%` (excluding scribal). This carries some clear implications about the social status of subscribers, and potentially these rates could be compared to data from studies of literacy.


```{r qs_petrs_waffle_subscribers_signatures, fig.alt='waffle chart of subscriber signatures in the Power of Petitioning Quarter Sessions collections. '}

qs_subs %>%
  filter(!is.na(signature_type)) %>%
  count(signature_type) %>% #filter(signature_type!="scribe") %>% mutate(p=n/sum(n)*100)
  ggplot(aes(fill=signature_type, values=n)) +
  geom_waffle(colour="white", flip=TRUE, #make_proportional = TRUE, 
              n_rows = 50) +
  coord_equal() +
  theme_minimal() +
  theme_enhance_waffle() +
  #scale_fill_tableau(guide = guide_legend(reverse = TRUE)) +
  scale_fill_pander(guide = guide_legend(reverse = TRUE)) +
  #theme(legend.position = "bottom",strip.text = element_text(angle = 45)) +
  labs(fill="type", caption="1 square = 1 subscriber", title="Signature types for subscribers")
```


### counties

Not for the first time, Derbyshire is anomalous and difficult to interpret because of its small numbers and gaps (and the high % of scribal "signatures" may say more about the county's clerks and record-keeping practices than about its petitioners). Cheshire doesn't offer the same excuse and the low % of petitioners signing is very striking. Worcestershire meanwhile has a considerably higher % of marks than the other counties. 

Westminster has by some distance the highest % of petitioner signing their names, and (notwithstanding my caveats) that probably really does reflect higher levels of literacy in London. But it seems less likely that literacy was substantially lower in Cheshire than in neighbouring Staffordshire and Worcestershire, so why are the % so much lower?

```{r qs_petrs_waffle_petitioners_signatures_county, fig.alt='waffle charts of petitioner signatures in the Power of Petitioning Quarter Sessions collections, comparing by county.'}
#  qs_petrs_... , fig.alt='type of chart... of ... in the Power of Petitioning Quarter Sessions collections, note any interesting points about presentation. summarise any key findings not mentioned/enumerated in text'
  qs_petitioners %>%
  filter(!is.na(signature_type)) %>%
  #filter(!is.na(petitioner_signed)) %>%
  count(county, signature_type) %>%
  group_by(county) %>%
  mutate(p = n/sum(n)*100) %>%
  ungroup() %>%
  ggplot(aes(fill=signature_type, values=n)) +
  geom_waffle(colour="white", flip=TRUE, make_proportional = TRUE, n_rows = 5) +
  coord_equal() +
  facet_wrap(~county, nrow=1) +
  theme_minimal() +
  theme_enhance_waffle() +
  #scale_fill_tableau() +
  scale_fill_pander(guide = guide_legend(reverse = TRUE)) +
  #theme(legend.position = "bottom",strip.text = element_text(angle = 45)) +
  labs(fill="signature\ntype", caption="1 square = 1% of petitioners", title="Signature types, by county")
```

### gender

The lower % of women signing their petitions with autograph signatures might come as no surprise. But this also highlights that petitioners who could not write their names didn't normally choose to sign with a mark instead. 

```{r qs_petrs_waffle_petitioners_signatures_gender, fig.alt='waffle charts of petitioner signatures in the Power of Petitioning Quarter Sessions collections, comparing male and female petitioners. Only about 5% of female petitioners signed their petitions, compared to 21% of men.'}
qs_petitioners %>%
  filter(!is.na(signature_type), gender %in% c("male", "female")) %>%
  count(gender, signature_type) %>%
  group_by(gender) %>%
  mutate(p = n/sum(n)*100) %>%
  ungroup() %>%
  ggplot(aes(fill=signature_type, values=n)) +
  geom_waffle(colour="white", flip=TRUE, make_proportional = TRUE, n_rows = 10) +
  coord_equal() +
  facet_wrap(~gender, nrow=1) +
  theme_minimal() +
  theme_enhance_waffle() +
  #scale_fill_tableau() +
  scale_fill_pander(guide = guide_legend(reverse = TRUE)) +
  #theme(legend.position = "bottom",strip.text = element_text(angle = 45)) +
  labs(fill="signature\ntype", caption="1 square = 1% of petitioners", title="Signature types, by gender")
```



### petition topics


```{r}
# ah now you need that petitioner_signed thing
percent_signed_grp <- function(grp){
  qs_petitioners %>%
  filter(!is.na(signature_type), signature_type!="scribe", topic!="other") %>%
  count({{grp}}, petitioner_signed) %>%
  group_by({{grp}}) %>%
  mutate(p = n/sum(n), s=sum(n)) %>%
  filter(petitioner_signed=="signed") %>%
  ggplot(aes(fct_reorder({{grp}}, p), p)) +
  geom_point(aes(size=s), shape="square") +
  geom_col(width=0.03) +
  coord_flip() +
  scale_y_continuous(labels = percent_format(), limits = c(0,1)) +
  labs(y="% of petitioners", x=NULL, size="number of\npetitioners")
}
```



Association between the presence of signatures and specific petition topics is very clear: again, even if this isn't directly about literacy, there are obvious correlations between higher signing % and topics where you might expect petitioners to be of higher/middling status, and the lowest % of signing are mostly related to poor relief. (There's no obvious relationship between signing and the size of a topic.)

```{r qs_petrs_lollipop_petitioners_signatures_topic, fig.alt='lollip chart of percentage of petitioners in the Power of Petitioning Quarter Sessions collections who signed petitions, comparing by petition topic. Only debtors and dissenters signed more than 50% of the time; in the topics related to poor relief less than 10% of petitioners did so.'}
# um where's military?
percent_signed_grp(topic) +
  labs(x="topic", title="Petitioners signing petitions, by topic")
```

### change over time


```{r}
  # qs_petitioners_combined %>%
  # filter(!is.na(decade), county!="Herts") %>%
  # count(county, decade, petitioner_signed) %>%
  # group_by(decade) %>%
  # mutate(p = n/sum(n), s=sum(n)) %>%
  # filter(petitioner_signed=="y") %>%
  # ggplot(aes(decade, p)) +
  # geom_point() +
  # #geom_smooth(formula = y~x, method="loess") +
  # facet_wrap(~county, ncol = 1) +
  # scale_y_continuous(labels = percent_format(), limits = c(0,1)) +
  # labs(y="% of petitioners", size="number of\npetitioners", title="Petitioners signing petitions, by decade")
```


Here, however, there *is* a strong relationship between the popularity of petitioning and the % of petitioners signing their petitions, as well as the obvious change over time. (`51` Westminster petitions couldn't be dated to within a decade. However, all were from c.1620-1640 and none were signed by the petitioners, so they'd make very little difference to this picture.)

Between the 1610s and 1670s and in the 1690s (the rise in the 1680s is intriguing), signing rates never rose above `10%` of petitioners. Also, even though numbers are relatively small, the rate seems consistently much higher in the late 16th century, around `25-30%`. From 1700 signing rates rise dramatically again; from the 1710s they never fall below `50%` and peak in the 90s in mid century. 

(It's also worth remembering that petitioning declined much more sharply in Cheshire after the 1680s than in the other counties.) 


```{r qs_petrs_scatter_petitioners_signatures_decade, fig.alt='scatter chart of percentages of petitioners who signed their petitions in the Power of Petitioning Quarter Sessions collections, break down by decade from late 16th to late 18th century. In the first half of the 17th century less than 10% signed, whereas during the 18th century more than 60% signed their petitions in almost every decade (and in some decades it was more than 80%).'}
  qs_petitioners %>%
  filter(!is.na(petitioner_signed) ) %>%
  count(decade, petitioner_signed) %>%
  group_by(decade) %>%
  mutate(p = n/sum(n), s=sum(n)) %>%
  ungroup() %>%
  filter(petitioner_signed=="signed") %>%
  ggplot(aes(decade, p)) +
  geom_point(aes(size=s), shape="square") +
  geom_smooth(formula = y~x, method="loess") +
  #coord_flip() +
  scale_y_continuous(labels = percent_format(), limits = c(0,1)) +
  labs(y="% of petitioners", size="number of\npetitioners", title="Petitioners signing petitions, by decade", caption = "excludes petitions that couldn't be dated to within a decade")
```

Tracking the % of petitions that have subscribers diverges from the chart for petitioners in some interesting ways. The % is consistently low in the first half of the 17th century, suddenly rises in the 1650s, falls again in the early 18th century before gradually increasing over the rest of that century. Could the sudden jump around 1650 suggest the influence of political revolution on collective activity in much more mundane areas of life?

```{r qs_petrs_scatter_petitions_with_subscribers_decade , fig.alt='scatter chart of the percentage of petitions with subscribers in the Power of Petitioning Quarter Sessions collections, by decade between late 16th and late 18th century.'}
# subscribers - intriguing...
# this looks slightly different from original - did it include Herts? if not, ought to be the same.
qs_petitions_combined %>%
  filter(!is.na(decade)) %>%
  count(decade, subscribers>0) %>%
  group_by(decade) %>%
  mutate(p = n/sum(n), s=sum(n)) %>%
  filter(`subscribers > 0`==TRUE)%>%
  ggplot(aes(decade, p)) +
  geom_point(aes(size=s), shape="square") +
  geom_smooth(formula = y~x, method="loess") +
  #coord_flip() +
  scale_y_continuous(labels = percent_format(), limits = c(0,1)) +
  labs(y="% of petitions", size="number of\npetitions", title="Petitions with subscribers, by decade", caption = "excludes petitions that couldn't be dated to within a decade")
```


```{r}
#number of subscribers per petition per decade?
# qs_subscribers_combined %>%
#   filter(!is.na(decade), signature_type!="scribe") %>%
#   count(decade, reference, county) %>%
#   ggplot(aes(decade, n)) +
#   geom_jitter() +
#   geom_smooth() +
#   scale_y_log10()
```


